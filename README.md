# Курсовой проект к видеокурсу от Megafon

## Задача

Построить алгоритм, который для каждой пары пользователь-услуга определит вероятность подключения услуги.

## Данные

В качестве исходных данных доступна информация об отклике абонентов на предложение подключения одной из услуг (файлы data_train.csv и data_test.csv).

Каждому пользователю может быть сделано несколько предложений в разное время, каждое из которых он может или принять, или отклонить.

Отдельным набором данных будет являться нормализованный анонимизированный набор признаков, характеризующий профиль потребления абонента (файл features.csv). Эти данные привязаны к определенному времени, поскольку профиль абонента может меняться с течением времени.

Данные train и test разбиты по периодам – на train доступно 4 месяцев, а на test отложен последующий месяц.

### Итого, в качестве входных данных будут представлены:

● **data_train.csv:** id, vas_id, buy_time, target
● **features.csv.zip:** id, <feature_list>

### И тестовый набор:

● **data_test.csv:** id, vas_id, buy_time

target - целевая переменная, где 1 означает подключение услуги, 0 - абонент
не подключил услугу соответственно.
buy_time - время покупки, представлено в формате timestamp, для работы с
этим столбцом понадобится функция datetime.fromtimestamp из модуля
datetime.
id - идентификатор абонента
vas_id - подключаемая услуга

### Примечание:

Размер файла features.csv в распакованном виде весит 20 гб, для
работы с ним можно воспользоваться pandas.read_csv, либо можно воспользоваться
библиотекой Dask.

## Список файлов

1) [data_preprocessing.ipynb](data_preprocessing.ipynb) - предобработка данных

2) [model_pipeline.ipynb](model_pipeline.ipynb) - основная часть: обработка признаков, балансировка данных, построение пайплайнов, обучение моделей, предсказания и оценка качества моделей, выбор CatBoostClassifier в качестве основной модели для предсказания на тестовой выборке

3) [cat_boost_classifier_model.pickle](cat_boost_classifier_model.pickle) - обученная модель CatBoostClassifier в формате pickle

4) [answers_test.csv](answers_test.csv) - файл с ответами, предсказание вероятности подключения услуги по тестовой выборке

5) [Презентация.pdf](Презентация.pdf) - презентация к проекту, также есть в формате [pptx](Презентация.pptx)

6) [Инструкция.pdf](Инструкция.pdf) - инструкция к выполнению проекта, также есть в формате [docx](Инструкция.docx)

## Запуск проекта

Для запуска проекта понадобятся следующие файлы:
 
1) data_train.csv
2) data_test.csv
3) features.csv.zip

Их можно скачать по [ссылке](https://drive.google.com/drive/folders/1LCUYS7uXKKZenNn8fUTjq_iupelNRAfQ)

Файлы должны находиться в корне проекта. Архив features.csv.zip нужно распаковать.